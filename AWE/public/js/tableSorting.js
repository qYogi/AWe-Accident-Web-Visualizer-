var c=class{constructor(){this.currentSort=null,this.originalData=[],this.setupSorting()}setData(e){this.originalData=[...e]}setupSorting(){let e=document.querySelector("#accidents-table-head");e&&e.addEventListener("click",t=>{let r=t.target;if(r.tagName==="TH"&&r.classList.contains("sortable-header")){let s=r.getAttribute("data-column");s&&this.handleSort(s)}})}handleSort(e){if(!this.originalData.length)return;let t;if(!this.currentSort||this.currentSort.column!==e)t="asc";else switch(this.currentSort.state){case"asc":t="desc";break;case"desc":t="neutral";break;default:t="asc"}this.currentSort=t==="neutral"?null:{column:e,state:t},this.updateSortIndicators(e,t);let r=this.sortData(this.originalData,e,t);this.displaySortedData(r)}sortData(e,t,r){return r==="neutral"?[...this.originalData]:[...e].sort((i,n)=>{let o=i[t],a=n[t];return t==="severity"?(o=parseFloat(o)||0,a=parseFloat(a)||0):t==="start_time"||t==="end_time"?(o=new Date(o).getTime(),a=new Date(a).getTime()):(o=(o||"").toString().toLowerCase(),a=(a||"").toString().toLowerCase()),o<a?r==="asc"?-1:1:o>a?r==="asc"?1:-1:0})}updateSortIndicators(e,t){document.querySelectorAll("#accidents-table-head th.sortable-header").forEach(s=>{let i=s,n=i.getAttribute("data-column");i.classList.remove("sort-asc","sort-desc","sort-neutral"),n===e?i.classList.add(`sort-${t}`):i.classList.add("sort-neutral")})}displaySortedData(e){let t=document.querySelector("#accidents-table tbody");t&&(t.innerHTML="",e.forEach(r=>{let s=document.createElement("tr");["id","severity","start_time","end_time","description","street","city","county","state","country"].forEach(n=>{let o=document.createElement("td"),a=r[n]||"";n.includes("time")&&a&&(a=new Date(a).toLocaleString()),o.textContent=a,o.setAttribute("title",a),s.appendChild(o)}),t.appendChild(s)}))}createSortableHeaders(){let e=document.querySelector("#accidents-table-head");if(!e)return;let t=["severity","start_time","end_time","street","city","state"];e.querySelectorAll("th").forEach((s,i)=>{let n=s.textContent?.toLowerCase().replace(/\s+/g,"_")||"";t.includes(n)&&(s.classList.add("sortable-header"),s.setAttribute("data-column",n),s.classList.add("sort-neutral"))})}resetSorting(){this.currentSort=null,this.updateSortIndicators("","neutral"),this.displaySortedData(this.originalData)}},d=new c;export{c as TableSorter,d as tableSorter};
